# 🧠 ROS1 노드 매니저의 기능: ROS Master

ROS1 시스템은 여러 개의 독립적인 실행 파일인 **노드 (Node)**들이 메시지 통신을 통해 협력하며 로봇을 작동하게 합니다. 이러한 노드들의 중앙 관리 시스템 역할을 하는 것이 바로 ros master입니다.

- 역할: ros master는 시스템 내의 모든 노드, 토픽, 서비스에 대한 정보를 가지고 있는 이름 서버와 같습니다.

- 핵심 기능:

    - 노드 등록/삭제: 새로운 노드가 실행되거나 종료될 때 이를 시스템에 등록하고 관리합니다.

    - 연결 중개: 노드들이 서로 통신할 수 있도록 어떤 노드가 어떤 토픽을 발행하고 구독하는지 정보를 제공하여 P2P (Peer-to-Peer) 연결을 맺도록 중개합니다.

💡 주의: ros master는 통신 자체를 중개하지만, 실제 메시지 데이터는 노드들이 master를 통해 연결 정보를 받은 후, 서로 직접 통신합니다.

## ➕ 노드를 추가하는 세 가지 방법

ROS 시스템에 새로운 노드를 생성하고 동작시키는 방법은 크게 세 가지가 있습니다.

1. 📢 터미널 명령어를 통한 임시 노드 생성 (디버깅/테스트)

rostopic, rosservice와 같은 ROS 기본 CLI 도구를 사용할 때, 해당 명령이 실행되는 동안 임시 노드가 생성됩니다.

원리: 명령어가 토픽을 구독하거나 발행하는 행위를 수행하기 위해 백그라운드에서 임시 ROS 노드를 초기화합니다.

예시 (노드 생성): 아래 명령어를 수행하면 해당 터미널 세션이 종료되거나 ctrl+c로 명령이 중단될 때까지 **/rostopic_X**와 같은 이름의 임시 구독 노드가 생성됩니다.

```bash
$ rostopic echo /cmd_vel
```

```bash
$ rostopic pub -r 10 /cmd_vel geometry_msgs/Twist '...'
```
위 명령 역시 토픽을 주기적으로 발행하는 임시 노드를 생성합니다.

2. 🐍 코드를 통한 노드 초기화 (개발/실습)

Python (rospy)이나 C++ (roscpp) 코드를 작성하고 실행하여 노드를 만드는 가장 일반적인 방법입니다. 해당 코드가 실행되는 동안 노드가 유지됩니다.

```python
# rospy.init_node('노드_이름') 을 통해 노드가 초기화되고 생성됩니다.
import rospy 
# ... (생략)
rospy.init_node('mini_pi_keyboard_controller', anonymous=True)
# ... (생략)
```

3. 🚀 Launch 파일을 사용한 노드 관리 (운영/배포)

여러 노드를 동시에 실행하고, 파라미터를 설정하며, 통신 이름(remap)을 조정하는 등 시스템 전체를 관리할 때 사용되는 가장 강력한 방법입니다. Launch 파일은 안정적인 로봇 시스템 운영의 핵심입니다.

## 🛠️ 노드 및 코드 분석에 활용하는 방법

노드를 직접적으로 변경하는 일은 드물지만, 새로운 기능을 만들거나 기존 기능을 분석하기 위해 노드 정보를 확인하고 해당 코드를 참조하는 활용 상황은 매우 많습니다.

|명령어|기능|설명|
|------|---|---|
|rosnode list|현재 활성화된 모든 노드의 이름을 출력합니다.|시스템의 현재 동작 상태를 파악하는 첫 단계입니다.|
|rosnode info /(node 이름)|특정 노드의 정보를 확인합니다.|해당 노드가 어떤 토픽을 구독/발행하는지, 어떤 서비스를 제공하는지, 그리고 어떤 패키지에서 만들어졌는지 확인할 수 있습니다.|
|roscd (패키지 이름)|노드가 만들어진 패키지 경로로 이동합니다.|rosnode info에서 확인한 패키지 이름으로 이동하여 소스 코드를 직접 분석할 수 있습니다.|


































초안
---
---
# 노드 매니저의 기능
mini pi에서는 ros1을 기반으로 동작합니다.

ros1에서는 노드들이 메시지를 통신하며 로봇을 작동하게 합니다. 이러한 노드들을 관리하는 '매니저'의 기능을 하는 요소가 필요합니다.
master가 이러한 역할을 수행합니다. 각 노드들이 등록, 삭제 됩니다.


# 노드를 추가하는 방법
노드를 추가하는 방법은 세가지가 있습니다.
하나는 터미널 상에서 메시지를 보내거나 받을 때, 해당 명령이 유지되는 동안 노드가 생깁니다.
또 다른 하나는 코드를 통해 노드를 초기화 하여 해당 코드가 실행되는 동안 노드가 생깁니다.
마지막은 런치파일을 사용하여 노드를 만드는 것입니다.

아래 명령어를 수행하면 
```bash
$ rostopic echo /cmd_vel
```

```python

```

# 사용하는 방법
노드를 직접적으로 변경 할 일은 드뭅니다.
하지만 새로운 기능을 만들면서 노드를 생성하거나, 참조하는 등 활용하는 상황이 많습니다.

특정 노드에서 어떻게 코드가 돌아가는지 분석하기 위해 노드에서 패키지로 이동할 수 있습니다.

```bash
$ rosnode list
$ rosnode info /(node 이름) # 여기서 node가 만들어지는 패키지를 확인할 수 있습니다.
$ roscd (패키지) # 여기서 코드들을 확인할 수 있습니다.
```